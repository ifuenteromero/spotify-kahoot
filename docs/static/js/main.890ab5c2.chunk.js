(this["webpackJsonpspotify-kahoot"]=this["webpackJsonpspotify-kahoot"]||[]).push([[0],{31:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},64:function(e,t,n){},85:function(e,t,n){var r={"./correct.wav":86,"./tac.wav":87,"./tic.wav":88,"./wrong.wav":89};function c(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}c.keys=function(){return Object.keys(r)},c.resolve=a,e.exports=c,c.id=85},86:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/correct.baf02d2f.wav"},87:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/tac.89a4e37f.wav"},88:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/tic.515725ec.wav"},89:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/media/wrong.4bbcbf38.wav"},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),a=n(46),s=n.n(a),o=(n(60),n(61),n(31),"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("544d168202f2468eb818f980220e2f60","&redirect_uri=").concat("https://ifuenteromero.github.io/spotify-kahoot/","&scope=").concat(["user-read-currently-playing","user-read-recently-played","user-read-playback-state","user-top-read","user-modify-playback-state","playlist-read-private"].join("%20"),"&response_type=token&show_dialog=true")),i=function(){return Object(r.jsxs)("div",{className:"login",children:[Object(r.jsx)("img",{src:"https://getheavy.com/wp-content/uploads/2019/12/spotify2019-830x350.jpg",alt:"spotify-logo"}),Object(r.jsx)("a",{className:"button--primary",href:o,children:"login with spotify"})]})},u=(n(62),n(14)),l=n.n(u),j=n(19),d=n(6),f=n(108),b=(n(64),n(47)),O=n.n(b).a.create({baseURL:"https://api.spotify.com/v1/"}),p=localStorage.getItem("TOKEN");O.defaults.headers.common.Authorization="Bearer ".concat(p),O.ChangeToken=function(e){return O.defaults.headers.common.Authorization="Bearer ".concat(e)};O.interceptors.response.use(null,(function(e){if(401===e.response.status){localStorage.removeItem("TOKEN"),window.location="/spotify-kahoot/#/login"}else console.log("Ocurri\xf3 un error");return Promise.reject(e)}));var v=function(){var e,t=Object(c.useState)(null),n=Object(d.a)(t,2),a=n[0],s=n[1],o=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get("/me");case 2:t=e.sent,n=t.data,s(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){o()}),[]),Object(r.jsxs)("div",{className:"user",children:[Object(r.jsx)(f.a,{alt:null===a||void 0===a?void 0:a.display_name,src:null===a||void 0===a||null===(e=a.images[0])||void 0===e?void 0:e.url,className:"user__avatar"}),Object(r.jsx)("span",{className:"user__name",children:null===a||void 0===a?void 0:a.display_name})]})},h=n(17),m=n(4),x=n(35),g="/me/playlists",y=function(e,t){return Math.floor(Math.random()*(t-e))+e},w=Object(c.createContext)(),k=function(e){var t=Object(m.f)(),a=e.children,s=g,o=Object(c.useRef)(),i=Object(c.useRef)(),u=Object(c.useState)([]),f=Object(d.a)(u,2),b=f[0],p=f[1],v=Object(c.useState)([]),h=Object(d.a)(v,2),k=h[0],N=h[1],C=Object(c.useState)(!1),_=Object(d.a)(C,2),E=_[0],I=_[1],S=Object(c.useState)(1),T=Object(d.a)(S,2),R=T[0],P=T[1],Q=Object(c.useState)({id:null,preview_url:null}),L=Object(d.a)(Q,2),V=L[0],D=L[1];Object(c.useEffect)((function(){U()}),[]);var U=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get(s);case 2:return t=e.sent,n=t.data.items,e.next=6,Promise.all(n.map(function(){var e=Object(j.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.get((n=t.id,"/playlists/".concat(n,"/tracks"))));case 1:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:r=e.sent,c=r.reduce((function(e,t){var n=t.data.items.map((function(e){return e.track})).filter((function(e){return e.preview_url}));return e=[].concat(Object(x.a)(e),Object(x.a)(n))}),[]),p(c);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=function(e,t){for(var n=[];n.length<e;){var r=y(0,t-1);n.includes(n)||n.push(r)}return n}(4,b.length),t=e.map((function(e){return b[e]})),n=y(0,4);D(b[e[n]]),N(t)},B=Object(c.useState)(E),F=Object(d.a)(B,2),K=F[0],M=F[1],A=function(e){I(!0)},J=function(){setTimeout((function(){o.current.pause(),t.push("/play")}),5e3)};return Object(r.jsx)(w.Provider,{value:{tracks:b,randomTrack:V,playerRef:o,answers:k,isValidated:E,handleValidate:A,setIsCorrect:M,isCorrect:K,handleNextQuestion:function(){P(R+1)},getQuestion:function(){z(),J()},resetQuestions:function(){I(!1),M(!1)},trackDuration:5e3,soundRef:i,handleCorrect:function(e,t){A();var r=e===t;M(r);var c=function(e){var t=n(85),r={};return t.keys().forEach((function(e){var n=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf("."));r[n]=t(e).default})),r[e]}(r?"correct":"wrong");i.current.src=c,i.current.play()}},children:a})},N=(n(92),function(){var e=Object(c.useContext)(w),t=e.randomTrack,n=e.playerRef;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)("audio",{controls:!0,ref:n,autoPlay:!0,className:"player",children:Object(r.jsx)("source",{src:null===t||void 0===t?void 0:t.preview_url,type:"audio/mpeg"})})})}),C=n(109),_=function(){var e=Object(c.useContext)(w).trackDuration,t=Object(c.useState)(0),n=Object(d.a)(t,2),a=n[0],s=n[1],o=e/100,i=function(){s((function(e){return e+1}))};return Object(c.useEffect)((function(){var e=setInterval(i,o);return function(){return clearInterval(e)}}),[]),Object(r.jsx)(C.a,{variant:"determinate",value:a})},E=function(){var e=Object(c.useContext)(w).getQuestion;return Object(c.useEffect)(e,[]),Object(r.jsxs)("div",{className:"listening",children:[Object(r.jsx)(_,{}),Object(r.jsx)(N,{})]})},I=function(e){var t=e.order,n=e.answer,a=Object(c.useContext)(w),s=a.randomTrack,o=a.isValidated,i=a.handleCorrect,u=null===n||void 0===n?void 0:n.name,l=null===n||void 0===n?void 0:n.artists.map((function(e){return e.name})).join(" & "),j=null===n||void 0===n?void 0:n.id,d=null===s||void 0===s?void 0:s.id,f=o?d===j?"right":"wrong":"";return Object(r.jsxs)("button",{className:"answer--".concat(t," ").concat(f),"data-id":j,disabled:o,onClick:function(){return i(d,j)},children:[Object(r.jsx)("span",{className:"answer__text",children:l}),Object(r.jsx)("span",{className:"answer__text",children:u})]})},S=(n(93),function(){var e=Object(c.useContext)(w).answers;return Object(r.jsx)("div",{className:"answers",children:e.map((function(e,t){return Object(r.jsx)(I,{order:t+1,answer:e},t)}))})}),T=function(){var e=Object(c.useContext)(w),t=e.isValidated,n=e.isCorrect,a=t?n?"correct":"wrong":"";return Object(r.jsx)("div",{children:a})},R=function(){var e=Object(c.useContext)(w),t=e.isValidated,n=e.handleNextQuestion;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)(h.b,{to:"/listening",className:"button--secondary",onClick:n,children:"Next"})})},P=n(107),Q=(n(94),function(){var e=Object(c.useState)(10),t=Object(d.a)(e,2),n=t[0],a=t[1];Object(c.useEffect)((function(){var e=setInterval((function(){a((function(t){if(t>0)return t-=1;clearInterval(e)}))}),1e3);return function(){return clearInterval(e)}}),[]);var s=100-10*n;return Object(r.jsxs)("div",{className:"timer",children:[Object(r.jsx)(P.a,{variant:"static",value:s}),Object(r.jsx)("span",{className:"timer__text",children:n})]})}),L=function(){var e=Object(c.useContext)(w).soundRef;return Object(r.jsx)("audio",{ref:e,children:Object(r.jsx)("source",{type:"audio/mpeg"})})},V=function(){var e=Object(c.useContext)(w).resetQuestions;return Object(c.useEffect)((function(){return function(){return e()}}),[]),Object(r.jsxs)("div",{className:"question",children:[Object(r.jsx)(Q,{}),Object(r.jsx)(S,{}),Object(r.jsx)(L,{}),Object(r.jsx)(T,{}),Object(r.jsx)(R,{})]})},D=function(){return Object(r.jsx)("div",{className:"landing",children:Object(r.jsx)(h.b,{className:"button--primary",to:"/listening",children:"Play"})})},U=Object(c.createContext)(),z=function(e){var t=e.children,n=Object(c.useState)(!1),a=Object(d.a)(n,2),s=a[0],o=a[1],i="TOKEN",u=function(){var e=Object(j.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.location.hash.substring(2).split("&").reduce((function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e}),{}),n=t.access_token,window.location.hash="",n&&(localStorage.setItem(i,n),O.ChangeToken(n),o(!0));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useLayoutEffect)((function(){var e=localStorage.getItem(i);o(!!e),u()}),[]),Object(r.jsx)(U.Provider,{value:{isLogged:s},children:t})},B=n(29),F=n(51),K=function(e){var t=e.path,n=e.component,a=e.render,s=Object(F.a)(e,["path","component","render"]),o=Object(c.useContext)(U).isLogged;return Object(r.jsx)(m.b,Object(B.a)(Object(B.a)({},s),{},{path:t,render:function(e){return o?n?Object(r.jsx)(n,Object(B.a)({},e)):a(e):Object(r.jsx)(m.a,{to:"/login"})}}))},M=function(){return Object(r.jsx)("div",{className:"app",children:Object(r.jsx)(h.a,{children:Object(r.jsxs)(z,{children:[Object(r.jsx)(K,{path:"/(|listening|play)",render:function(){return Object(r.jsx)("header",{className:"header",children:Object(r.jsx)(v,{})})}}),Object(r.jsxs)("main",{className:"main",children:[Object(r.jsx)(m.b,{path:"/login",component:i}),Object(r.jsxs)(k,{children:[Object(r.jsx)(K,{path:"/listening",component:E}),Object(r.jsx)(K,{path:"/play",component:V}),Object(r.jsx)(K,{exact:!0,path:"/",component:D})]})]})]})})})};s.a.render(Object(r.jsx)(M,{}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.890ab5c2.chunk.js.map