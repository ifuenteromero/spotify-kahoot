(this["webpackJsonpspotify-kahoot"]=this["webpackJsonpspotify-kahoot"]||[]).push([[0],{30:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},79:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),c=n(44),s=n.n(c),i=(n(58),n(12)),o=n.n(i),u=n(18),l=n(7),j=(n(60),n(61),n(30),"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("544d168202f2468eb818f980220e2f60","&redirect_uri=").concat("https://ifuenteromero.github.io/spotify-kahoot/","&scope=").concat(["user-read-currently-playing","user-read-recently-played","user-read-playback-state","user-top-read","user-modify-playback-state","playlist-read-private"].join("%20"),"&response_type=token&show_dialog=true")),d=function(){return Object(r.jsxs)("div",{className:"login",children:[Object(r.jsx)("img",{src:"https://getheavy.com/wp-content/uploads/2019/12/spotify2019-830x350.jpg",alt:"spotify-logo"}),Object(r.jsx)("a",{className:"button--primary",href:j,children:"login with spotify"})]})},f=n(45),b=n.n(f).a.create({baseURL:"https://api.spotify.com/v1/"});b.ChangeToken=function(e){return b.defaults.headers.common.Authorization="Bearer ".concat(e)};var p=n(99),O=(n(79),function(e){var t,n=e.user;return Object(r.jsxs)("div",{className:"user",children:[Object(r.jsx)(p.a,{alt:null===n||void 0===n?void 0:n.display_name,src:null===n||void 0===n||null===(t=n.images[0])||void 0===t?void 0:t.url,className:"user__avatar"}),Object(r.jsx)("span",{className:"user__name",children:null===n||void 0===n?void 0:n.display_name})]})}),h=n(17),v=n(4),m=function(){return Object(r.jsx)("div",{className:"landing",children:Object(r.jsx)(h.b,{className:"button--primary",to:"/listening",children:"Play"})})},x=n(34),y="/me/playlists",g=function(e,t){return Math.floor(Math.random()*(t-e))+e},w=Object(a.createContext)(),k=function(e){var t=Object(v.e)(),n=e.children;console.log({history:t});var c=y,s=Object(a.useRef)(),i=Object(a.useState)([]),j=Object(l.a)(i,2),d=j[0],f=j[1],p=Object(a.useState)([]),O=Object(l.a)(p,2),h=O[0],m=O[1],k=Object(a.useState)(!1),N=Object(l.a)(k,2),C=N[0],_=N[1],S=Object(a.useState)(1),E=Object(l.a)(S,2),I=E[0],Q=E[1],T=Object(a.useState)({id:null,preview_url:null}),V=Object(l.a)(T,2),R=V[0],P=V[1];Object(a.useEffect)((function(){F()}),[]);var F=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get(c);case 2:return t=e.sent,n=t.data.items,e.next=6,Promise.all(n.map(function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b.get((n=t.id,"/playlists/".concat(n,"/tracks"))));case 1:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:r=e.sent,a=r.reduce((function(e,t){var n=t.data.items.map((function(e){return e.track})).filter((function(e){return e.preview_url}));return e=[].concat(Object(x.a)(e),Object(x.a)(n))}),[]),f(a);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=function(e,t){for(var n=[];n.length<e;){var r=g(0,t-1);n.includes(n)||n.push(r)}return n}(4,d.length),t=e.map((function(e){return d[e]})),n=g(0,4);P(d[e[n]]),m(t)},B=Object(a.useState)(C),D=Object(l.a)(B,2),J=D[0],M=D[1],U=function(){setTimeout((function(){s.current.pause(),t.push("/play")}),5e3)};return Object(r.jsx)(w.Provider,{value:{tracks:d,randomTrack:R,playerRef:s,answers:h,isValidated:C,handleValidate:function(e){_(!0)},setIsCorrect:M,isCorrect:J,handleNextQuestion:function(){Q(I+1)},getQuestion:function(){z(),U()},resetQuestions:function(){_(!1),M(!1)},trackDuration:5e3},children:n})},N=function(e){var t=e.order,n=e.answer,c=Object(a.useContext)(w),s=c.randomTrack,i=c.handleValidate,o=c.isValidated,u=c.setIsCorrect,l=null===n||void 0===n?void 0:n.name,j=null===n||void 0===n?void 0:n.artists.map((function(e){return e.name})).join(" & "),d=null===n||void 0===n?void 0:n.id,f=null===s||void 0===s?void 0:s.id;return Object(r.jsxs)("div",{className:"answer--".concat(t," ").concat(o?f===d?"right":"wrong":""),"data-id":d,onClick:function(e){i(),u(f===d)},children:[Object(r.jsx)("span",{className:"answer__text",children:j}),Object(r.jsx)("span",{className:"answer__text",children:l})]})},C=(n(85),function(){var e=Object(a.useContext)(w).answers;return console.log({answers:e}),Object(r.jsx)("div",{className:"answers",children:e.map((function(e,t){return Object(r.jsx)(N,{order:t+1,answer:e},t)}))})}),_=function(){var e=Object(a.useContext)(w),t=e.isValidated,n=e.isCorrect,c=t?n?"correct":"wrong":"";return Object(r.jsx)("div",{children:c})},S=function(){var e=Object(a.useContext)(w),t=e.isValidated,n=e.handleNextQuestion;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)(h.b,{to:"/listening",className:"button--secondary",onClick:n,children:"Next"})})},E=function(){var e=Object(a.useContext)(w).resetQuestions;return Object(a.useEffect)((function(){return function(){return e()}}),[]),Object(r.jsxs)("div",{className:"question",children:[Object(r.jsx)(C,{}),Object(r.jsx)(_,{}),Object(r.jsx)(S,{})]})},I=(n(86),function(){var e=Object(a.useContext)(w),t=e.randomTrack,n=e.playerRef;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)("audio",{controls:!0,ref:n,autoPlay:!0,className:"player",children:Object(r.jsx)("source",{src:null===t||void 0===t?void 0:t.preview_url,type:"audio/mpeg"})})})}),Q=n(100),T=function(){var e=Object(a.useContext)(w).trackDuration,t=Object(a.useState)(0),n=Object(l.a)(t,2),c=n[0],s=n[1],i=e/100,o=function(){s((function(e){return e+1}))};return Object(a.useEffect)((function(){var e=setInterval(o,i);return function(){return clearInterval(e)}}),[]),Object(r.jsx)(Q.a,{variant:"determinate",value:c})},V=function(){var e=Object(a.useContext)(w).getQuestion;return Object(a.useEffect)(e,[]),Object(r.jsxs)("div",{className:"listening",children:[Object(r.jsx)(T,{}),Object(r.jsx)(I,{})]})},R=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],s=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.get("/me");case 2:t=e.sent,n=t.data,c(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){s()}),[]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("header",{className:"header",children:Object(r.jsx)(O,{user:n})}),Object(r.jsx)("main",{className:"main",children:Object(r.jsx)(h.a,{children:Object(r.jsxs)(k,{children:[Object(r.jsx)(v.a,{path:"/listening",component:V}),Object(r.jsx)(v.a,{path:"/play",component:E}),Object(r.jsx)(v.a,{exact:!0,path:"/",component:m})]})})})]})},P=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1],s=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.location.hash.substring(1).split("&").reduce((function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e}),{}),n=t.access_token,window.location.hash="",n&&(c(n),b.ChangeToken(n));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){s()}),[]),Object(r.jsx)("div",{className:"app",children:n?Object(r.jsx)(R,{}):Object(r.jsx)(d,{})})};s.a.render(Object(r.jsx)(P,{}),document.getElementById("root"))}},[[87,1,2]]]);
//# sourceMappingURL=main.12388ebc.chunk.js.map