(this["webpackJsonpspotify-kahoot"]=this["webpackJsonpspotify-kahoot"]||[]).push([[0],{47:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},68:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),a=n(36),s=n.n(a),o=(n(47),n(9)),i=n.n(o),u=n(15),l=n(10),j=(n(49),n(50),"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("544d168202f2468eb818f980220e2f60","&redirect_uri=").concat("https://ifuenteromero.github.io/spotify-kahoot/","&scope=").concat(["user-read-currently-playing","user-read-recently-played","user-read-playback-state","user-top-read","user-modify-playback-state","playlist-read-private"].join("%20"),"&response_type=token&show_dialog=true")),d=function(){return Object(r.jsxs)("div",{className:"login",children:[Object(r.jsx)("img",{src:"https://getheavy.com/wp-content/uploads/2019/12/spotify2019-830x350.jpg",alt:"spotify-logo"}),Object(r.jsx)("a",{href:j,children:"login with spotify"})]})},f=n(37),p=n.n(f).a.create({baseURL:"https://api.spotify.com/v1/"});p.ChangeToken=function(e){return p.defaults.headers.common.Authorization="Bearer ".concat(e)};var b=n(89),O=(n(68),function(e){var t,n=e.user;return Object(r.jsxs)("div",{className:"user",children:[Object(r.jsx)(b.a,{alt:null===n||void 0===n?void 0:n.display_name,src:null===n||void 0===n||null===(t=n.images[0])||void 0===t?void 0:t.url,className:"user__avatar"}),Object(r.jsx)("span",{className:"user__name",children:null===n||void 0===n?void 0:n.display_name})]})}),h=n(14),v=n(3),x=function(){return Object(r.jsx)(h.b,{to:"/listening",children:"Play"})},m=n(26),y="/me/playlists",g=function(e,t){return Math.floor(Math.random()*(t-e))+e},w=Object(c.createContext)(),k=function(e){var t=Object(v.e)(),n=e.children;console.log({history:t});var a=y,s=Object(c.useRef)(),o=Object(c.useState)([]),j=Object(l.a)(o,2),d=j[0],f=j[1],b=Object(c.useState)([]),O=Object(l.a)(b,2),h=O[0],x=O[1],k=Object(c.useState)(!1),_=Object(l.a)(k,2),C=_[0],N=_[1],S=Object(c.useState)(1),E=Object(l.a)(S,2),Q=E[0],T=E[1],V=Object(c.useState)({id:null,preview_url:null}),R=Object(l.a)(V,2),I=R[0],P=R[1];Object(c.useEffect)((function(){F()}),[]);var F=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get(a);case 2:return t=e.sent,n=t.data.items,e.next=6,Promise.all(n.map(function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p.get((n=t.id,"/playlists/".concat(n,"/tracks"))));case 1:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:r=e.sent,c=r.reduce((function(e,t){var n=t.data.items.map((function(e){return e.track})).filter((function(e){return e.preview_url}));return e=[].concat(Object(m.a)(e),Object(m.a)(n))}),[]),f(c);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=function(e,t){for(var n=[];n.length<e;){var r=g(0,t-1);n.includes(n)||n.push(r)}return n}(4,d.length),t=e.map((function(e){return d[e]})),n=g(0,4);P(d[e[n]]),x(t)},B=Object(c.useState)(C),J=Object(l.a)(B,2),M=J[0],U=J[1],A=function(){setTimeout((function(){s.current.pause(),window.location="/#/play"}),5e3)};return Object(r.jsx)(w.Provider,{value:{tracks:d,randomTrack:I,playerRef:s,answers:h,isValidated:C,handleValidate:function(e){N(!0)},setIsCorrect:U,isCorrect:M,handleNextQuestion:function(){T(Q+1)},getQuestion:function(){z(),A()},resetQuestions:function(){N(!1),U(!1)}},children:n})},_=function(e){var t=e.order,n=e.answer,a=Object(c.useContext)(w),s=a.randomTrack,o=a.handleValidate,i=a.isValidated,u=a.setIsCorrect,l=null===n||void 0===n?void 0:n.name,j=null===n||void 0===n?void 0:n.artists.map((function(e){return e.name})).join(" & "),d=null===n||void 0===n?void 0:n.id,f=null===s||void 0===s?void 0:s.id;return Object(r.jsxs)("div",{className:"answer--".concat(t," ").concat(i?f===d?"right":"wrong":""),"data-id":d,onClick:function(e){o(),u(f===d)},children:[Object(r.jsx)("span",{className:"answer__text",children:j}),Object(r.jsx)("span",{className:"answer__text",children:l})]})},C=(n(74),function(){var e=Object(c.useContext)(w).answers;return console.log({answers:e}),Object(r.jsx)("div",{className:"answers",children:e.map((function(e,t){return Object(r.jsx)(_,{order:t+1,answer:e},t)}))})}),N=function(){var e=Object(c.useContext)(w),t=e.isValidated,n=e.isCorrect,a=t?n?"correct":"wrong":"";return Object(r.jsx)("div",{children:a})},S=function(){var e=Object(c.useContext)(w),t=e.isValidated,n=e.handleNextQuestion;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)(h.b,{to:"/listening",onClick:n,children:"Next"})})},E=function(){var e=Object(c.useContext)(w).resetQuestions;return Object(c.useEffect)((function(){return function(){return e()}}),[]),Object(r.jsxs)("div",{children:[Object(r.jsx)(C,{}),Object(r.jsx)(N,{}),Object(r.jsx)(S,{})]})},Q=(n(75),function(){var e=Object(c.useContext)(w),t=e.randomTrack,n=e.playerRef;return Object(r.jsx)(r.Fragment,{children:t&&Object(r.jsx)("audio",{controls:!0,ref:n,autoPlay:!0,className:"player",children:Object(r.jsx)("source",{src:null===t||void 0===t?void 0:t.preview_url,type:"audio/mpeg"})})})}),T=function(){var e=Object(c.useContext)(w).getQuestion;return Object(c.useEffect)(e,[]),Object(r.jsx)(Q,{})},V=function(){var e=Object(c.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1],s=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/me");case 2:t=e.sent,n=t.data,a(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){s()}),[]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(O,{user:n}),Object(r.jsxs)(h.a,{children:[Object(r.jsx)(v.a,{path:"/listening",component:T}),Object(r.jsx)(v.a,{path:"/play",component:E}),Object(r.jsx)(v.a,{exact:!0,path:"/",component:x})]})]})},R=function(){var e=Object(c.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1],s=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.location.hash.substring(1).split("&").reduce((function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e}),{}),n=t.access_token,window.location.hash="",n&&(a(n),p.ChangeToken(n));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){s()}),[]);var o=Object(r.jsx)(k,{children:Object(r.jsx)(V,{})});return Object(r.jsx)("div",{className:"app",children:n?o:Object(r.jsx)(d,{})})};s.a.render(Object(r.jsx)(R,{}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.f9e8380a.chunk.js.map